 \documentclass[amsmath,amssymb,aps,prd,10pt,twocolumn,showkeys]{revtex4}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{empheq}
\DeclareMathOperator\erfc{erfc}
\DeclareMathOperator\erf{erf}
\DeclareMathOperator{\sgn}{sgn}
\begin{document}

\title{Complex Analysis of Askaryan Radiation: Towards UHE-$\nu$ energy Reconstruction via the Hilbert Envelope of Observed Signals}

\author{Jordan C. Hanson}
\email{jhanson2@whittier.edu}
\affiliation{Department of Physics and Astronomy, Whittier College}
\author{Raymond Hartig}
\affiliation{Department of Physics and Astronomy, Whittier College}
\date{\today}

\begin{abstract}
This is a work in progress.
\end{abstract}

\keywords{Ultra-high energy neutrino; Askaryan radiation; Mathematical physics}

\maketitle

\section{Introduction}

The introduction.

\section{Units, Definitions, and Conventions}
\label{sec:unit}

The units.

\section{Collection of Main Results}
\label{sec:onc}

Here is a list of the basic results and ideas for this paper.

\begin{itemize}
\item Let the signal model $s(t)$ be
\begin{equation}
s(t) = -E_0 t e^{-\frac{1}{2}\left(t/\sigma_t\right)^2} \label{eq:s}
\end{equation}
This is the off-cone field equation from \cite{PhysRevD.105.123019}.  The parameter $\sigma_{\rm t}$ is the pulse width, and it depends two quantities: the longitudinal length of the UHE-$\nu$-induced cascade, and the angle at which the cascade is observed relative to the Cherenkov angle.  The parameter $E_0$ is the amplitude normalization, and it depends on two parameters: $\sigma_{\rm t}$, and $\omega_{\rm 0}$, the cutoff frequency from the cascade form factor.
\item Let $\widehat{s}(t)$ represent the Hilbert transform of $s(t)$.  The \textit{analytic signal} of $s(t)$ is
\begin{equation}
s_{\rm a}(t) = s(t) + j \widehat{s}(t)
\end{equation}
The magnitude of the analytic signal, $|s_a(t)|$, is the \textit{envelope} of the signal.  The Hilbert transform $\widehat{s}(t)$ is equivalent to the convolution of $s(t)$ and the tempered distribution $h(t) = 1/(\pi t)$.
\item Let $S(f)$ be the Fourier transform of $s(t)$.  The Fourier transform of the analytic signal is
\begin{equation}
\mathcal{F}\lbrace s_{\rm a}(t) \rbrace_{f} = S_{\rm a}(f) = S(f)(1+\sgn{f}) \label{eq:sa_1}
\end{equation}
The sign function, $\sgn$ gives $-1$ if $f<0$, $0$ if $f=0$, and $1$ if $f>1$.
\item Taking the inverse Fourier transform of Eq. \ref{eq:sa_1}, the analytic signal may be written in terms of $S(f)$:
\begin{equation}
s_{\rm a}(t) = 2\int_{0}^{\infty} S(f) e^{2\pi j f t} df \label{eq:sa_2}
\end{equation}
\item The Fourier transform of Eq. \ref{eq:s} is
\begin{equation}
S(f) = E_0 \sigma_t^3 (2\pi)^{3/2} j f e^{-2\pi^2 f^2 \sigma_t^2}
\end{equation}
\item Using the gaussian spectral width $\sigma_{\rm f}$ from \cite{10.1016/j.astropartphys.2017.03.008}, and the guassian width of $s(t)$ from \cite{PhysRevD.105.123019}, it was shown in \cite{PhysRevD.105.123019} that the uncertainty principle holds for off-cone signals:
\begin{equation}
\sigma_t \sigma_f \geq \frac{1}{2\pi}
\end{equation}
The equality is reached in the limit the far-field parameter limits to zero: $\eta \to 0$.  This makes the signal spectrum
\begin{equation}
S(f) = E_0 \sigma_t^3 (2\pi)^{3/2} j f e^{-\frac{1}{2}\left(f/\sigma_f\right)^2} \label{eq:spec}
\end{equation}
Inserting $S(f)$ into Eq. \ref{eq:sa_2}, $s_{\rm a}(t)$ is
\begin{equation}
s_{\rm a}(t) = \frac{E_0 \sigma_t^3 (2\pi)^{3/2}}{\pi} \frac{d}{dt}\int_0^{\infty} e^{-\frac{1}{2}\left(f/\sigma_f\right)^2} e^{2\pi j f t} df \label{eq:sa_3}
\end{equation}
\item Let $k^2/4 = \frac{1}{2}\left(f/\sigma_f\right)^2$, and $x = t/(\sqrt{2}\sigma_t)$.  Equation \ref{eq:sa_3} can be broken into real and imaginary parts:
\begin{align}
s_{\rm a}(t) &= \frac{E_0 \sigma_{\rm t}}{\sqrt{2\pi}}\frac{dI}{dx} \\
\Re\lbrace I \rbrace &= \int_0^{\infty} e^{-k^2/4}\cos(kx) dk \\
\Im\lbrace I \rbrace &= \int_0^{\infty} e^{-k^2/4}\sin(kx) dk
\end{align}
The real part of $I$ is even, so it can be extended to $(-\infty,\infty)$ if it is multiplied by $1/2$.  The result is
\begin{equation}
\Re\lbrace I \rbrace = \sqrt{\pi} e^{-x^2}
\end{equation}
The imaginary part of $I$ is proportional to \textit{Dawson's integral, $D(x)$:}
\begin{equation}
\Im\lbrace I\rbrace = 2 D(x)
\end{equation}
\item The overall analytic signal, $s_a(t)$, is
\begin{equation}
s_a(t) = -E_0 \left(t e^{-\frac{1}{2}\left(t/\sigma_t\right)^2} - \frac{2 j\sigma_t}{\sqrt{2\pi}} \frac{dD(x)}{dx}\right) \label{eq:sa_4}
\end{equation}
The signal envelope is $|s_a(t)|$.  It is important to note that, though $D(x)$ is not evaluated analytically, a high-precision algorithm for computing $D(x)$ was given in \cite{10.1063/1.4822832}.  Note that $s_a(0) \neq 0$, since $dD(x)/dx = 1 - 2x D(x)$.
\item Signal data in detectors designed to observe Askaryan pulses is equivalent to the convolution of the signal and detector response functions.  Signal models are convolved with measured detector responses to create \textit{signal templates}.  Signal templates are cross-correlated with observed data to identify UHE-$\nu$ signals.  The oscillations of signal templates and observed data can introduce various uncertainties when cross-correlated.  This problem intensifies when the signal-to-noise ratio between Askaryan pulse data and thermal noise decreases.  To reduce these uncertainties, the Hilbert envelope of observed signals is used in cross-correlations instead of the original signals.  We seek an analytic equation for the Hilbert envelope of the data.  That is, we seek the envelope of the convolution of the analytic signal model with a typical detector response.  The RLC damped oscillator is a standard circuit model for the RF dipole antennas used in RNO-G and the proposed IceCube Gen2 \cite{10.1103/PhysRevD.85.062004,10.1088/1748-0221/16/03/p03025,10.48550/arxiv.2008.04323}.
\item There are two paths to calculating the final result.  The first option involves three steps.  First, the detector response, $r(t)$ is convolved with $s(t)$.  Second, the analytic signal of the result is found.  Third, the magnitude of the analytic signal is computed, which can be compared to envelopes of observed signals.  The second option involves computing the envelope of the convolution of $r(t)$ with $s(t)$ directly from $s_a(t)$ and $r_a(t)$.
\item Let $x(t) * y(t)$ represent the convolution of two functions $x(t)$ and $y(t)$.  Let the envelope of the convolution be $\mathcal{E}_{x * y}(t)$.  $\mathcal{E}_{x * y}(t)$, $x_a(t)$, and $y_a(t)$ are related by
\begin{equation}
\mathcal{E}_{x * y}(t) = \frac{1}{2}| x_a (t) * y_a(t)| \label{eq:awesome}
\end{equation}
We should include the proof here (I have to track it down in my notebooks).
\item The analytic signal of the Askaryan pulse is given by Eq. \ref{eq:sa_4}.  The RLC damped oscillator response and corresponding analytic signal are
\begin{align}
r(t) &= R_0 e^{-\gamma t} \cos(2\pi f_0 t) \\
r_a(t) &= R_0 e^{-\gamma t} e^{2\pi j f_0 t} \label{eq:ra}
\end{align}
The parameter $\gamma$ is the \textit{decay constant}, and the parameter $f_0$ is the resonance frequency.  Note that the envelope of $r(t)$, $|r_a(t)|$, is simply $R_0 \exp(-\gamma t)$, as it should be.  The proof of Eq. \ref{eq:ra} is as follows:
\begin{align}
r(t) &= R_0 e^{-\gamma t} \cos(2\pi f_0 t) \\
R(f) &= \frac{R_0}{2\pi j} \left( \frac{f - \frac{j\gamma}{2\pi}}{(f-z_+)(f-z_-)} \right) \\
z_+ &= f_0 + \frac{j\gamma}{2\pi} \\
z_- &= -f_0 + \frac{j\gamma}{2\pi} \\
\widehat{r}(t) &= \mathcal{F}^{-1}\left \lbrace - j \sgn(f) R(f) \right \rbrace \label{eq:rh} \\ 
\widehat{r}(t) &= \frac{R_0}{2j}\left( e^{2\pi j f_0 t} - e^{-2\pi j f_0 t} \right) e^{-\gamma t} \\
\widehat{r}(t) &= R_0 \sin(2\pi f_0 t) e^{-\gamma t} \\
r_a (t) &= R_0 \left(\cos(2\pi f_0 t) + j\sin(2\pi f_0 t)\right) e^{-\gamma t} \\
r_a (t) &= R_0 e^{2\pi j f_0 t} e^{-\gamma t}
\end{align}
In evaluating the inverse Fourier transform in Eq. \ref{eq:rh}, the poles at $z_+$ and $z_-$ must be enclosed in separate contour integrals.
\item The goal is now to apply Eq. \ref{eq:awesome} by convolving $s_a(t)$ with $r_a(t)$.  The real part of $s_a(t)$ can be convolved with $r_a(t)$ in the time domain.  As in Eq. \ref{eq:sa_4}, real part of $s_a(t)$ is $s(t)$.  Since $r_a(t<0)=0$, the convolution is written
\begin{equation}
r_a(t) * \Re\lbrace s_a(t) \rbrace = \int_0^{\infty} r(\tau) s(t-\tau) d\tau
\end{equation}
Let $x=t/(\sqrt{2}\sigma_t)$, $y=\tau/(\sqrt{2}\sigma_t)$, and $z_0 = \sqrt{2}\sigma_t(\gamma-2\pi jf_0)$. The convolution may be organized as follows
\begin{equation}
r_a(t) * \Re\lbrace s_a(t) \rbrace = R_0 s(t) I + R_0 E_0 \sigma_t^2 e^{-\frac{1}{2}(t/\sigma_t^2)} \frac{dI}{dt} \label{eq:conv}
\end{equation}
with
\begin{equation}
I(x,z_0) = \sqrt{2}\sigma_t \int_0^{\infty} e^{-y^2 + (2x-z_0)y} dy
\end{equation}
Let $b = x-z_0/2$. Completing the square in the exponent produces
\begin{equation}
I(x,z_0) = \sqrt{2}\sigma_t e^{b^2} \int_0^{\infty} e^{-(y-b)^2} dy
\end{equation}
The integral may be cast as a complementary error function by substituting $u=y-b$ and letting $b=jz$:
\begin{equation}
I(x,z_0) = \sqrt{\frac{\pi}{2}}\sigma_t e^{-z^2}\erfc(-jz)
\end{equation}
Thus, the integral is proportional to the \textit{Faddeeva function}, $w(z)$:
\begin{equation}
I(x,z_0) = \sqrt{\frac{\pi}{2}} \sigma_t w(z) \label{eq:fadd}
\end{equation}
Subsituting Eq. \ref{eq:fadd} into Eq. \ref{eq:conv}, and simplifying, produces
\begin{multline}
r_a(t) * \Re\lbrace s_a(t) \rbrace = \sqrt{\frac{\pi}{2}}R_0 \sigma_t s(t) w(z) \\
-j\frac{\sqrt{\pi}}{2} R_0 E_0 \sigma_t^2 e^{-\frac{1}{2}(t/\sigma_t)^2} \frac{dw(z)}{dz}
\end{multline}
Turning to the convolution of $r_a(t)$ with $\Im(s_a)$, note that the imaginary part of Eq. \ref{eq:sa_4} contains $dD(x)/dx$, the derivative of the Dawson function.  To complete the convolution, the inverse Fourier transform of the product of the Fourier transforms of $r_a(t)$ and $\Im\lbrace s_a(t)\rbrace$ is calculated.  To complete this step, the Fourier transform of $dD(x)/dx$ is needed:
\begin{align}
x &= t/(\sqrt{2}\sigma_t) \\
f' &= \sqrt{2} \sigma_t f \\
\mathcal{F}\left\lbrace \frac{dD(x)}{dx}\right\rbrace &= \int_{-\infty}^{\infty} \frac{dD(x)}{dx}e^{-2\pi jft} dt \\
\mathcal{F}\left\lbrace \frac{dD(x)}{dx}\right\rbrace &= \sqrt{2}\sigma_t(2\pi jf') \int_{-\infty}^{\infty} D(x) e^{-2\pi jf'x} dx \\
\mathcal{F}\left\lbrace \frac{dD(x)}{dx}\right\rbrace &= 2\pi^2 \sigma_t^2 f e^{-\frac{1}{2}(f/\sigma_f)^2} \sgn(f)
\end{align}
Let $z_0 = (\gamma - 2\pi jf_0)$, so that the Fourier transform of $r_a$ is 
\begin{align}
\mathcal{F}\left\lbrace r_a(t)\right\rbrace &= R_0\int_{-\infty}^{\infty} e^{-zt} e^{-2\pi j ft} dt \\
\mathcal{F}\left\lbrace r_a(t)\right\rbrace &= \frac{R_0}{z_0+2\pi j f}
\end{align}
Let $z_1 = f_0 + j\gamma/(2\pi)$. Multiplying the Fourier transforms, and simplifying, yields
\begin{multline}
\mathcal{F}\left\lbrace r_a(t) * \Im\left\lbrace s_a(t)\right\rbrace \right\rbrace = \\ -j \sqrt{2\pi} R_0 E_0 \sigma^3 \frac{f\sgn(f) e^{-\frac{1}{2}(f/\sigma_f)^2}}{f-z_1}
\end{multline}
The inverse Fourier transform now gives $r_a(t) * \Im\left\lbrace s_a(t) \right\rbrace$:
\begin{multline}
r_a(t) * \Im\left\lbrace s_a(t) \right\rbrace = \\
-j\sqrt{2\pi} R_0 E_0 \sigma_t^3 \int_{-\infty}^{\infty} \frac{f\sgn(f)e^{-\frac{1}{2}(f/\sigma_f)^2}e^{2\pi jft}}{f-z_1} df
\end{multline}
Let $y = f/(\sqrt{2}\sigma_f)$, $x=t/(\sqrt{2}\sigma_t)$, $\sgn(f) = \sgn(y)$, and $z_1 \to f_0/(\sqrt{2}\sigma_f) + j\gamma/(2\pi \sqrt{2} \sigma_f)$.  The inverse Fourier transform can be organized as:
\begin{multline}
r_a(t) * \Im\left\lbrace s_a(t) \right\rbrace = \\
-\frac{R_0E_0\sigma_t^3}{\sqrt{2\pi}}\frac{d}{dt}\int_{-\infty}^{\infty} \frac{\sgn(y) e^{-y^2+2jxy}}{y-z_1} dy
\end{multline}
Completing the square in the exponent, factoring a unit of $j$ from the exponent, and changing the derivative from $d/dt$ to $d/dx$ gives
\begin{multline}
r_a(t) * \Im\left\lbrace s_a(t) \right\rbrace = \\
-\frac{R_0E_0\sigma_t^2}{2\sqrt{\pi}}\frac{d}{dx}e^{-x^2} \int_{-\infty}^{\infty} \frac{\sgn(y) e^{(x+jy)^2}}{y-z_1}
\end{multline}
\end{itemize}

\section{Conclusion}
\label{sec:conc}

The conclusion.

\appendix

\section{Details}
\label{app:a}

The details.

\bibliography{apssamp}

\end{document}

